import { Component } from "@/core";
import { getFormatDateTime } from "@/core/utils/DateUtils";
import { ChatGPTAPI } from 'chatgpt'

@Component('chatGptService')
export class ChatGptService {

    private chatGptApi

    constructor() {
        console.log('ChatGptService.constructor')
        this.loadChatGptApi()
    }

    public loadChatGptApi() {
        let chatGptApi = new ChatGPTAPI({
            sessionToken:'eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..j1KrGHx3ImOMLU5r.vrov8gr-BHHxebq-JEqfeAid8LkZE19W_QNMNDojiz1u4oizVDquBDkv8Y6bn7ylq4VAApGJaMM1pgZM6aPBZY9LDMW-PR6BOFSO6CNjIWhlyXtApjeoHa9_Qe675st9RCRiyVdpEfIUFYGi7bGticGshxtBDWHPMfNkUIG98_zHKhG5OshkOeU7f0fEl144X5Pe-mnmgDRyxxwcKkN5mwuviPkeRVtmq1Hjty3chPALYj29c_bVHma7XG1Uz9HeYbCbebOci6dlxexxDQr26RlRCIs-Jl32I_e-y-W_DjlCN85qaupt1Ui5phpo07KDH9BAmNS0rwLcvvtv2HSi2ZumuybsL1huZDoOqUHLnBolGBJhS2ta0tkh1Gu4FGAXgpJGez2g8qBoqS9cvNMYsonbzCBxHT02NRWvl5fFi4lZpRC1yo-b2VvMaPz78A5vGxuYXSD8zZ5MQnAbcHlFRKbklJxFxPOX4h4A_QSaFkHf3b6O9Lg4-Znh2mAFOcO8c6jrvr9mjxV2fszaKUcCief6TF4dZSDyGvjQO4YWZYZp9lYUMmM3nmLf23XajC-yShyAFtCr7Zmf0z1V0vBezNkvj3fsRwyfQ2I8EYs-LS35V9UJ2m6j3me0N3PZAhkGSwb1hOa9y5OrC8nqMFDrD-rQAvVHeqce5kDgIB94Hx8tG5ppqA3dQgiUvHGTEgIJUqxvSZu4jN4G8b08gN2Kn47r3MyMpBVKnJ73xEQXCzpkPW-JOIMmQSELZqsn7BhP6E1amS__3ktic_UJvIunAnv-ye9Q6a2EZFiv9xWfW_usm5zguRVQoRvdHo8fcqElmn4uoHdEDJj8qMei9LyNshC-VjPpZqRwPYmyA5N9BO4UjdyVxO5bju_0QF0qii6ry2ouvuMvdIKQKsvw8NrNKaYneOJMEYB1W_5dBnis4WMPwoDcpMuWXItE1ejvuKoDruuJo7daCsqZJ4YHGDgDMuyQcPC3rZN2ygU_Fvmt2awsZDOF8R0xVXfSPu1m_wItnwFMQ2w1xLnibilbM-1YIJB6TxHH0e73HDUrBLrVqOeJ_vcKxWizmwhdFKX7O2NEN-maODj5ePDARYjUwITmMxLwOBlHbk7ZL5XFP4-ERyujlkDLkotXsgPXLTdhIAER2Jpj95yslWmCV8D_ZnegLTSuSVG-ryS8TGPm46N_IHJY9Pm0oiIl0QObt4z4aId376-YG0eiTyhHNPMy7nv2sIuLQZGImhVJ2l_8cBV1u1h4X2vwVR2WwVDlGr6l218ZWaKBhKB5DhT-81HelvLdZp0-SdnN9bu2JbKwqdkd2jNw7xGNdzyF05CjVYMniF1Q14ycR5VmU1AhDQP5Nlty5ily9rplKz5gymuabThunJEewUt5q_0XBUYWUyNBuXVWFdvS_PTXF6j3Iy2qAaTMnd5L6iJYaUbcGqu2NUXrIJqbmy2NbqvaJDyRdORBbCc_hGPd_vM5UIiCY0TacMFjOurcPAJISS949XkjRxwRYLXYRRKIHrDWTVY6M4CPM4Rujz4tYIdVPEFsfpW0ujXiCAjVK-l1-iBdWhrZp-ojZN_RIO7wTx1K26OsqcD5dAsKt2Te62nRQiUxwtWYxgFC14MSeczReqYA5bPQ7lADDlHb1NP6KTmpP6Mx2V5gKHCapaKtRiTf1mnA0ftfwZlji5qDiVJql7_fR3s5rAxps0p5QA4WyTB5IFDwYTD20O0bACZPHs6dgmEJ6HDDMl0SskwRtfZgEXEdjhLQ3NEQi6tRQHdF2e1LGJxd9DxR-Beap6NpxNkW-LCYaa81ytgjfhIXs8IuHJXdg4rnDtGtNZiVVC2BqCFzt-EoRQZEu_GqaC-P6uguoRixEJr1f8Y9bKW2Tz4PfZZVf5RneKTox7q2Z0LnwhmqWCM_zy7RFCynaYJyHfYJ-GrZNUtBLIv_p0Sx0k4ZyftC3FAd5ZtrcKqTk1Nalwz8i_GLdmzp81elk62zH1ZnAP42zA_0DxH4gqZHqfeulDPq4vU7ceTkCkzckrn2dzcVvtShJxEz72Us9apkcCueMoR-BqSX2TaKm3yzRlVzt2RmTP-zwjPYaf1LcWiQTERkRV_-5qMD30PYBGbOwfso3orRLVou4wVpdRldq3YRUpnDzTuH_71xSWq9Aq3zR4waeCil1jlOh_swgh_5ReqqTV7ld58eAKOFXGfNngG3Dk6n0pJwxqD0cTuhLrKfzUx2NHbeCQIvQZ9AVzrTJfjXe2QSbO_g_gRJ89vTt9U2yOTviCYykjfpJO94x9I4dWwJwqLw5EGmpstScHvZ_tDEn2XS8TMb0R28fMPjEhb8.qpkpi1x17qzr1iXcmOWH8w'
        })
        this.chatGptApi = chatGptApi
    }

    public async send(msg: string) {
        console.log(`[${getFormatDateTime()}]发送消息：${msg}`)
        let data = await this.chatGptApi.sendMessage(msg)
        console.log(`[${getFormatDateTime()}]返回消息：\n${data}`)
        return data
    }

}